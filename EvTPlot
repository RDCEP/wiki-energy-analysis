import matplotlib.pyplot as plt
import matplotlib.dates as mdates
import datetime
import csv


__author__ = 'Carah Alexander'


# will plot data in an Time v Energy ScatterPlot

def graph(sheet, timespanStart, timespanEnd, delta):
    """
    :param sheet: is the file to be graphed
    :param timespanStart: when data measurements began (day, hour, min)
    :param timespanEnd: when data measurements ended (day, hour, min)
    :param delta: length of time between each data point (day, hour, min)
    :return: Time v. Energy ScatterPlot
    """
    file = open(sheet)

    power = []
    x1 = []

    reader = csv.DictReader(file)
    
     for row in reader:
        # extract row
        utc = row['utc']
        # parse into datetime
        format_withtime = '%m/%d/%y %H:%M'
        format_no_time = '%m/%d/%y'
        try:
            dt_struct = time.strptime(utc, format_withtime)
        except ValueError:
            dt_struct = time.strptime(utc, format_no_time)
        dt = datetime.datetime.fromtimestamp(time.mktime(dt_struct))

        x1.append(dt)
        power.append(row['use'])

    for row in reader:
    # power[len(power):] = [row['use']]
        power.append(row['use'])

    print(len(power))
    print(len(x1))

    fig = plt.figure()
    plt.plot_date(x1, power, "ro", xdate=True, ydate=False)

    plt.title('Time vs. Energy Consumption for' + file.name)
    plt.xlabel('Time (15 minute intervals)')
    plt.ylabel('Energy consumed in kW/h')

    fig.autofmt_xdate()
    plt.show()



graph('DATA_1334.csv', [1, 0, 0], [1, 0, 0], [0, 0, 15])
