import csv
import scipy.stats

def correlate(file1, col1, file2, col2):
    """
    :param file1: first comparison data set (needs to be a set of numbers)
    :param file2: second comparison data set ^^^^^^
    :param col1: name of column where data is found in file1
    :param col2: name of column where data is found in file 2
    :return: correlation coefficient
    """
    f1 = open(file1)
    f2 = open(file2)

    reader1 = csv.DictReader(f1)
    reader2 = csv.DictReader(f2)

    comp1 = []

    comp2 = []

    for row in reader1:
        comp1.append(float(row[col1]))

    for row in reader2:
        comp2.append(float(row[col2]))

    r = scipy.stats.spearmanr(comp1, comp2)

    print(r)



correlate('DATA_2158_summed.csv', 'use_sum', 'Temperature_Cities.csv','Austin')
